<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Step 3 | Sarayu and Alice Weather AI</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Step 3" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Step 3" />
<meta property="og:description" content="Step 3" />
<link rel="canonical" href="https://sarayu-pr11.github.io/sarayucsa/jupyter/2023/05/31/step3.html" />
<meta property="og:url" content="https://sarayu-pr11.github.io/sarayucsa/jupyter/2023/05/31/step3.html" />
<meta property="og:site_name" content="Sarayu and Alice Weather AI" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-05-31T00:00:00-05:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Step 3" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-31T00:00:00-05:00","datePublished":"2023-05-31T00:00:00-05:00","description":"Step 3","headline":"Step 3","mainEntityOfPage":{"@type":"WebPage","@id":"https://sarayu-pr11.github.io/sarayucsa/jupyter/2023/05/31/step3.html"},"url":"https://sarayu-pr11.github.io/sarayucsa/jupyter/2023/05/31/step3.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/sarayucsa/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://sarayu-pr11.github.io/sarayucsa/feed.xml" title="Sarayu and Alice Weather AI" /><link rel="shortcut icon" type="image/x-icon" href="/sarayucsa/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/sarayucsa/">Sarayu and Alice Weather AI</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/sarayucsa/search/">Search</a><a class="page-link" href="/sarayucsa/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-05-31-step3.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we inputted good and usable data for the model to learn from, we can use the predictions that have been made thus far to find how accurate they are.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">backtest</span><span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">rr</span><span class="p">,</span> <span class="n">predictors</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span>

<span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;actual&quot;</span><span class="p">],</span> <span class="n">predictions</span><span class="p">[</span><span class="s2">&quot;prediction&quot;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The output of this code should tell us the mean error of all the predictions. In this case, we have a mean absolute error of 5.13932667966084</p>
<p>this means that on average, our predictions were about 5 degrees off</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">pct_diff</span><span class="p">(</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">new</span> <span class="o">-</span> <span class="n">old</span><span class="p">)</span> <span class="o">/</span> <span class="n">old</span>

<span class="k">def</span> <span class="nf">compute_rolling</span><span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rolling_</span><span class="si">{</span><span class="n">horizon</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">weather</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">weather</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="n">horizon</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">weather</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">_pct&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pct_diff</span><span class="p">(</span><span class="n">weather</span><span class="p">[</span><span class="n">label</span><span class="p">],</span> <span class="n">weather</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">weather</span>
    
<span class="n">rolling_horizons</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
<span class="k">for</span> <span class="n">horizon</span> <span class="ow">in</span> <span class="n">rolling_horizons</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;tmax&quot;</span><span class="p">,</span> <span class="s2">&quot;tmin&quot;</span><span class="p">,</span> <span class="s2">&quot;prcp&quot;</span><span class="p">]:</span>
        <span class="n">weather</span> <span class="o">=</span> <span class="n">compute_rolling</span><span class="p">(</span><span class="n">weather</span><span class="p">,</span> <span class="n">horizon</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The function pct_diff takes two parameters, old and new, and calculates the percentage difference between them by subtracting old from new and dividing the result by old. It returns the computed percentage difference.</p>
<p>The function compute_rolling takes three parameters, weather (a DataFrame containing weather data), horizon (an integer representing the rolling window size), and col (a string specifying the column name to compute rolling averages and percentage differences for).</p>
<p>Inside the compute_rolling function, a label variable is created using f-string formatting to represent the rolling computation being performed. For example, if horizon is 3 and col is "tmax", the label will be "rolling_3_tmax".</p>
<p>The weather DataFrame is modified by adding a new column with the label computed above (weather[label]). This column represents the rolling average of the specified col over the given horizon. It is calculated using the rolling method of the DataFrame with the mean function applied to the specified col and a window size of horizon.</p>
<p>Another new column is added to the weather DataFrame, representing the percentage difference between the rolling average and the original col values. The new column's label is created by appending "_pct" to the rolling label (e.g., "rolling_3_tmax_pct"). The pct_diff function is called to calculate the percentage difference using the rolling average column and the original col column as inputs.</p>
<p>The modified weather DataFrame is returned from the compute_rolling function.</p>
<p>A list called rolling_horizons is defined, which contains the horizon values for the rolling computation.</p>
<p>A nested loop is used to iterate over each horizon in the rolling_horizons list and each col in the list ["tmax", "tmin", "prcp"].</p>
<p>Inside the nested loop, the compute_rolling function is called to compute rolling averages and percentage differences for the current horizon and col values. The modified weather DataFrame is assigned back to the weather variable, effectively updating it with the new columns.</p>
<p>In summary, this code calculates rolling averages and percentage differences for specified columns in a weather DataFrame. It iterates over different rolling window sizes (horizon) and columns (col) to perform the computations and modifies the DataFrame accordingly.</p>

</div>
</div>
</div>
</div>



      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/sarayucsa/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://sarayu-pr11.github.io/sarayucsa/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/sarayucsa/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>An easy to use blogging platform with support for Jupyter Notebooks.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li>
  <a rel="me" href="https://github.com/exampleUser" target="_blank" title="github">
    <svg class="svg-icon grey">
      <use xlink:href="/sarayucsa/assets/minima-social-icons.svg#github"></use>
    </svg>
  </a>
</li>
<li>
  <a rel="me" href="https://twitter.com/exampleUser" target="_blank" title="twitter">
    <svg class="svg-icon grey">
      <use xlink:href="/sarayucsa/assets/minima-social-icons.svg#twitter"></use>
    </svg>
  </a>
</li>
</ul>
</div>

  </div>

</footer>
</body>

</html>
